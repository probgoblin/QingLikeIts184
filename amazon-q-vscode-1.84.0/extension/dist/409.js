"use strict";exports.id=409,exports.ids=[409],exports.modules={6409:(lo,$s,u)=>{u.d($s,{getDefaultRoleAssumer:()=>Ds,getDefaultRoleAssumerWithWebIdentity:()=>ks});var Ie=u(71500),ve=u(34546),vt=u(8029),d=u(11650);const Ns=e=>({...e,useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,useGlobalEndpoint:e.useGlobalEndpoint??!1,defaultSigningName:"sts"}),Pt={UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class H extends d.TJ{constructor(t){super(t),Object.setPrototypeOf(this,H.prototype)}}class Pe extends H{constructor(t){super({name:"ExpiredTokenException",$fault:"client",...t}),this.name="ExpiredTokenException",this.$fault="client",Object.setPrototypeOf(this,Pe.prototype)}}class _e extends H{constructor(t){super({name:"MalformedPolicyDocumentException",$fault:"client",...t}),this.name="MalformedPolicyDocumentException",this.$fault="client",Object.setPrototypeOf(this,_e.prototype)}}class xe extends H{constructor(t){super({name:"PackedPolicyTooLargeException",$fault:"client",...t}),this.name="PackedPolicyTooLargeException",this.$fault="client",Object.setPrototypeOf(this,xe.prototype)}}class De extends H{constructor(t){super({name:"RegionDisabledException",$fault:"client",...t}),this.name="RegionDisabledException",this.$fault="client",Object.setPrototypeOf(this,De.prototype)}}class ke extends H{constructor(t){super({name:"IDPRejectedClaimException",$fault:"client",...t}),this.name="IDPRejectedClaimException",this.$fault="client",Object.setPrototypeOf(this,ke.prototype)}}class Me extends H{constructor(t){super({name:"InvalidIdentityTokenException",$fault:"client",...t}),this.name="InvalidIdentityTokenException",this.$fault="client",Object.setPrototypeOf(this,Me.prototype)}}class $e extends H{constructor(t){super({name:"IDPCommunicationErrorException",$fault:"client",...t}),this.name="IDPCommunicationErrorException",this.$fault="client",Object.setPrototypeOf(this,$e.prototype)}}class Ne extends H{constructor(t){super({name:"InvalidAuthorizationMessageException",$fault:"client",...t}),this.name="InvalidAuthorizationMessageException",this.$fault="client",Object.setPrototypeOf(this,Ne.prototype)}}const ne=e=>({...e,...e.SecretAccessKey&&{SecretAccessKey:d.$H}}),Os=e=>({...e,...e.Credentials&&{Credentials:ne(e.Credentials)}}),uo=e=>({...e,...e.SAMLAssertion&&{SAMLAssertion:SENSITIVE_STRING}}),ho=e=>({...e,...e.Credentials&&{Credentials:ne(e.Credentials)}}),Ls=e=>({...e,...e.WebIdentityToken&&{WebIdentityToken:d.$H}}),Hs=e=>({...e,...e.Credentials&&{Credentials:ne(e.Credentials)}}),mo=e=>({...e,...e.Credentials&&{Credentials:ne(e.Credentials)}}),fo=e=>({...e,...e.Credentials&&{Credentials:ne(e.Credentials)}}),yo=e=>({...e,...e.Credentials&&{Credentials:ne(e.Credentials)}});var Fs=u(12763),Ws=u(37234);const Oe=(e,t)=>(0,Ws.w)(e,t).then(s=>{if(s.length){const n=new Fs.XMLParser({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(c,y)=>y.trim()===""&&y.includes(`
`)?"":void 0});n.addEntity("#xD","\r"),n.addEntity("#10",`
`);let r;try{r=n.parse(s,!0)}catch(c){throw c&&typeof c=="object"&&Object.defineProperty(c,"$responseBodyText",{value:s}),c}const o="#text",i=Object.keys(r)[0],a=r[i];return a[o]&&(a[i]=a[o],delete a[o]),(0,d.rm)(a)}return{}}),Bs=async(e,t)=>{const s=await Oe(e,t);return s.Error&&(s.Error.message=s.Error.message??s.Error.Message),s},go=(e,t)=>{if(t?.Error?.Code!==void 0)return t.Error.Code;if(t?.Code!==void 0)return t.Code;if(e.statusCode==404)return"NotFound"},Us=e=>{let t=e.httpHandler;return{setHttpHandler(s){t=s},httpHandler(){return t},updateHttpClientConfig(s,n){t.updateHttpClientConfig(s,n)},httpHandlerConfigs(){return t.httpHandlerConfigs()}}},Ks=e=>({httpHandler:e.httpHandler()});var Ro=u(31932);class Eo{constructor({name:t,kind:s=FieldPosition.HEADER,values:n=[]}){this.name=t,this.kind=s,this.values=n}add(t){this.values.push(t)}set(t){this.values=t}remove(t){this.values=this.values.filter(s=>s!==t)}toString(){return this.values.map(t=>t.includes(",")||t.includes(" ")?`"${t}"`:t).join(", ")}get(){return this.values}}class se{constructor(t){this.method=t.method||"GET",this.hostname=t.hostname||"localhost",this.port=t.port,this.query=t.query||{},this.headers=t.headers||{},this.body=t.body,this.protocol=t.protocol?t.protocol.slice(-1)!==":"?`${t.protocol}:`:t.protocol:"https:",this.path=t.path?t.path.charAt(0)!=="/"?`/${t.path}`:t.path:"/",this.username=t.username,this.password=t.password,this.fragment=t.fragment}static clone(t){const s=new se({...t,headers:{...t.headers}});return s.query&&(s.query=zs(s.query)),s}static isInstance(t){if(!t)return!1;const s=t;return"method"in s&&"protocol"in s&&"hostname"in s&&"path"in s&&typeof s.query=="object"&&typeof s.headers=="object"}clone(){return se.clone(this)}}function zs(e){return Object.keys(e).reduce((t,s)=>{const n=e[s];return{...t,[s]:Array.isArray(n)?[...n]:n}},{})}class Le{constructor(t){this.statusCode=t.statusCode,this.reason=t.reason,this.headers=t.headers||{},this.body=t.body}static isInstance(t){if(!t)return!1;const s=t;return typeof s.statusCode=="number"&&typeof s.headers=="object"}}const Gs=async(e,t)=>{const s=z;let n;return n=X({...nn(e,t),[j]:On,[Q]:G}),K(t,s,"/",void 0,n)},To=async(e,t)=>{const s=z;let n;return n=X({...rn(e,t),[j]:Ln,[Q]:G}),K(t,s,"/",void 0,n)},js=async(e,t)=>{const s=z;let n;return n=X({...on(e,t),[j]:Hn,[Q]:G}),K(t,s,"/",void 0,n)},po=async(e,t)=>{const s=z;let n;return n=X({...an(e,t),[j]:Fn,[Q]:G}),K(t,s,"/",void 0,n)},So=async(e,t)=>{const s=z;let n;return n=X({...cn(e,t),[j]:Wn,[Q]:G}),K(t,s,"/",void 0,n)},Ao=async(e,t)=>{const s=z;let n;return n=X({...dn(e,t),[j]:Bn,[Q]:G}),K(t,s,"/",void 0,n)},Co=async(e,t)=>{const s=z;let n;return n=X({...ln(e,t),[j]:Un,[Q]:G}),K(t,s,"/",void 0,n)},wo=async(e,t)=>{const s=z;let n;return n=X({...un(e,t),[j]:Kn,[Q]:G}),K(t,s,"/",void 0,n)},bo=async(e,t)=>{const s=z;let n;return n=X({...hn(e,t),[j]:zn,[Q]:G}),K(t,s,"/",void 0,n)},Vs=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await Oe(e.body,t);let n={};return n=Rn(s.AssumeRoleResult,t),{$metadata:b(e),...n}},Io=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=En(s.AssumeRoleWithSAMLResult,t),{$metadata:b(e),...n}},qs=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await Oe(e.body,t);let n={};return n=Tn(s.AssumeRoleWithWebIdentityResult,t),{$metadata:b(e),...n}},vo=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=pn(s.AssumeRootResult,t),{$metadata:b(e),...n}},Po=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=Sn(s.DecodeAuthorizationMessageResult,t),{$metadata:b(e),...n}},_o=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=wn(s.GetAccessKeyInfoResult,t),{$metadata:b(e),...n}},xo=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=bn(s.GetCallerIdentityResult,t),{$metadata:b(e),...n}},Do=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=In(s.GetFederationTokenResult,t),{$metadata:b(e),...n}},ko=async(e,t)=>{if(e.statusCode>=300)return U(e,t);const s=await parseBody(e.body,t);let n={};return n=vn(s.GetSessionTokenResult,t),{$metadata:b(e),...n}},U=async(e,t)=>{const s={...e,body:await Bs(e.body,t)},n=Gn(e,s.body);switch(n){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":throw await Ys(s,t);case"MalformedPolicyDocument":case"com.amazonaws.sts#MalformedPolicyDocumentException":throw await en(s,t);case"PackedPolicyTooLarge":case"com.amazonaws.sts#PackedPolicyTooLargeException":throw await tn(s,t);case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":throw await sn(s,t);case"IDPRejectedClaim":case"com.amazonaws.sts#IDPRejectedClaimException":throw await Xs(s,t);case"InvalidIdentityToken":case"com.amazonaws.sts#InvalidIdentityTokenException":throw await Js(s,t);case"IDPCommunicationError":case"com.amazonaws.sts#IDPCommunicationErrorException":throw await Qs(s,t);case"InvalidAuthorizationMessageException":case"com.amazonaws.sts#InvalidAuthorizationMessageException":throw await Zs(s,t);default:const r=s.body;return Nn({output:e,parsedBody:r.Error,errorCode:n})}},Ys=async(e,t)=>{const s=e.body,n=An(s.Error,t),r=new Pe({$metadata:b(e),...n});return(0,d.Mw)(r,s)},Qs=async(e,t)=>{const s=e.body,n=Pn(s.Error,t),r=new $e({$metadata:b(e),...n});return(0,d.Mw)(r,s)},Xs=async(e,t)=>{const s=e.body,n=_n(s.Error,t),r=new ke({$metadata:b(e),...n});return(0,d.Mw)(r,s)},Zs=async(e,t)=>{const s=e.body,n=xn(s.Error,t),r=new Ne({$metadata:b(e),...n});return(0,d.Mw)(r,s)},Js=async(e,t)=>{const s=e.body,n=Dn(s.Error,t),r=new Me({$metadata:b(e),...n});return(0,d.Mw)(r,s)},en=async(e,t)=>{const s=e.body,n=kn(s.Error,t),r=new _e({$metadata:b(e),...n});return(0,d.Mw)(r,s)},tn=async(e,t)=>{const s=e.body,n=Mn(s.Error,t),r=new xe({$metadata:b(e),...n});return(0,d.Mw)(r,s)},sn=async(e,t)=>{const s=e.body,n=$n(s.Error,t),r=new De({$metadata:b(e),...n});return(0,d.Mw)(r,s)},nn=(e,t)=>{const s={};if(e[Y]!=null&&(s[Y]=e[Y]),e[ce]!=null&&(s[ce]=e[ce]),e[N]!=null){const n=pe(e[N],t);e[N]?.length===0&&(s.PolicyArns=[]),Object.entries(n).forEach(([r,o])=>{const i=`PolicyArns.${r}`;s[i]=o})}if(e[$]!=null&&(s[$]=e[$]),e[w]!=null&&(s[w]=e[w]),e[le]!=null){const n=xt(e[le],t);e[le]?.length===0&&(s.Tags=[]),Object.entries(n).forEach(([r,o])=>{const i=`Tags.${r}`;s[i]=o})}if(e[dt]!=null){const n=gn(e[dt],t);e[dt]?.length===0&&(s.TransitiveTagKeys=[]),Object.entries(n).forEach(([r,o])=>{const i=`TransitiveTagKeys.${r}`;s[i]=o})}if(e[Ke]!=null&&(s[Ke]=e[Ke]),e[de]!=null&&(s[de]=e[de]),e[ue]!=null&&(s[ue]=e[ue]),e[x]!=null&&(s[x]=e[x]),e[Je]!=null){const n=fn(e[Je],t);e[Je]?.length===0&&(s.ProvidedContexts=[]),Object.entries(n).forEach(([r,o])=>{const i=`ProvidedContexts.${r}`;s[i]=o})}return s},rn=(e,t)=>{const s={};if(e[Y]!=null&&(s[Y]=e[Y]),e[Xe]!=null&&(s[Xe]=e[Xe]),e[rt]!=null&&(s[rt]=e[rt]),e[N]!=null){const n=pe(e[N],t);e[N]?.length===0&&(s.PolicyArns=[]),Object.entries(n).forEach(([r,o])=>{const i=`PolicyArns.${r}`;s[i]=o})}return e[$]!=null&&(s[$]=e[$]),e[w]!=null&&(s[w]=e[w]),s},on=(e,t)=>{const s={};if(e[Y]!=null&&(s[Y]=e[Y]),e[ce]!=null&&(s[ce]=e[ce]),e[ht]!=null&&(s[ht]=e[ht]),e[et]!=null&&(s[et]=e[et]),e[N]!=null){const n=pe(e[N],t);e[N]?.length===0&&(s.PolicyArns=[]),Object.entries(n).forEach(([r,o])=>{const i=`PolicyArns.${r}`;s[i]=o})}return e[$]!=null&&(s[$]=e[$]),e[w]!=null&&(s[w]=e[w]),s},an=(e,t)=>{const s={};if(e[ct]!=null&&(s[ct]=e[ct]),e[Dt]!=null){const n=_t(e[Dt],t);Object.entries(n).forEach(([r,o])=>{const i=`TaskPolicyArn.${r}`;s[i]=o})}return e[w]!=null&&(s[w]=e[w]),s},cn=(e,t)=>{const s={};return e[ze]!=null&&(s[ze]=e[ze]),s},dn=(e,t)=>{const s={};return e[oe]!=null&&(s[oe]=e[oe]),s},ln=(e,t)=>({}),un=(e,t)=>{const s={};if(e[Ye]!=null&&(s[Ye]=e[Ye]),e[$]!=null&&(s[$]=e[$]),e[N]!=null){const n=pe(e[N],t);e[N]?.length===0&&(s.PolicyArns=[]),Object.entries(n).forEach(([r,o])=>{const i=`PolicyArns.${r}`;s[i]=o})}if(e[w]!=null&&(s[w]=e[w]),e[le]!=null){const n=xt(e[le],t);e[le]?.length===0&&(s.Tags=[]),Object.entries(n).forEach(([r,o])=>{const i=`Tags.${r}`;s[i]=o})}return s},hn=(e,t)=>{const s={};return e[w]!=null&&(s[w]=e[w]),e[de]!=null&&(s[de]=e[de]),e[ue]!=null&&(s[ue]=e[ue]),s},pe=(e,t)=>{const s={};let n=1;for(const r of e){if(r===null)continue;const o=_t(r,t);Object.entries(o).forEach(([i,a])=>{s[`member.${n}.${i}`]=a}),n++}return s},_t=(e,t)=>{const s={};return e[mt]!=null&&(s[mt]=e[mt]),s},mn=(e,t)=>{const s={};return e[Ze]!=null&&(s[Ze]=e[Ze]),e[We]!=null&&(s[We]=e[We]),s},fn=(e,t)=>{const s={};let n=1;for(const r of e){if(r===null)continue;const o=mn(r,t);Object.entries(o).forEach(([i,a])=>{s[`member.${n}.${i}`]=a}),n++}return s},yn=(e,t)=>{const s={};return e[qe]!=null&&(s[qe]=e[qe]),e[ut]!=null&&(s[ut]=e[ut]),s},gn=(e,t)=>{const s={};let n=1;for(const r of e)r!==null&&(s[`member.${n}`]=r,n++);return s},xt=(e,t)=>{const s={};let n=1;for(const r of e){if(r===null)continue;const o=yn(r,t);Object.entries(o).forEach(([i,a])=>{s[`member.${n}.${i}`]=a}),n++}return s},He=(e,t)=>{const s={};return e[Fe]!=null&&(s[Fe]=(0,d.lK)(e[Fe])),e[q]!=null&&(s[q]=(0,d.lK)(e[q])),s},Rn=(e,t)=>{const s={};return e[C]!=null&&(s[C]=re(e[C],t)),e[V]!=null&&(s[V]=He(e[V],t)),e[O]!=null&&(s[O]=(0,d.xW)(e[O])),e[x]!=null&&(s[x]=(0,d.lK)(e[x])),s},En=(e,t)=>{const s={};return e[C]!=null&&(s[C]=re(e[C],t)),e[V]!=null&&(s[V]=He(e[V],t)),e[O]!=null&&(s[O]=__strictParseInt32(e[O])),e[st]!=null&&(s[st]=__expectString(e[st])),e[it]!=null&&(s[it]=__expectString(e[it])),e[Ve]!=null&&(s[Ve]=__expectString(e[Ve])),e[ae]!=null&&(s[ae]=__expectString(e[ae])),e[Qe]!=null&&(s[Qe]=__expectString(e[Qe])),e[x]!=null&&(s[x]=__expectString(e[x])),s},Tn=(e,t)=>{const s={};return e[C]!=null&&(s[C]=re(e[C],t)),e[ot]!=null&&(s[ot]=(0,d.lK)(e[ot])),e[V]!=null&&(s[V]=He(e[V],t)),e[O]!=null&&(s[O]=(0,d.xW)(e[O])),e[tt]!=null&&(s[tt]=(0,d.lK)(e[tt])),e[ae]!=null&&(s[ae]=(0,d.lK)(e[ae])),e[x]!=null&&(s[x]=(0,d.lK)(e[x])),s},pn=(e,t)=>{const s={};return e[C]!=null&&(s[C]=re(e[C],t)),e[x]!=null&&(s[x]=__expectString(e[x])),s},re=(e,t)=>{const s={};return e[oe]!=null&&(s[oe]=(0,d.lK)(e[oe])),e[nt]!=null&&(s[nt]=(0,d.lK)(e[nt])),e[at]!=null&&(s[at]=(0,d.lK)(e[at])),e[Ue]!=null&&(s[Ue]=(0,d.Y0)((0,d.t_)(e[Ue]))),s},Sn=(e,t)=>{const s={};return e[Be]!=null&&(s[Be]=__expectString(e[Be])),s},An=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},Cn=(e,t)=>{const s={};return e[je]!=null&&(s[je]=__expectString(e[je])),e[q]!=null&&(s[q]=__expectString(e[q])),s},wn=(e,t)=>{const s={};return e[ie]!=null&&(s[ie]=__expectString(e[ie])),s},bn=(e,t)=>{const s={};return e[lt]!=null&&(s[lt]=__expectString(e[lt])),e[ie]!=null&&(s[ie]=__expectString(e[ie])),e[q]!=null&&(s[q]=__expectString(e[q])),s},In=(e,t)=>{const s={};return e[C]!=null&&(s[C]=re(e[C],t)),e[Ge]!=null&&(s[Ge]=Cn(e[Ge],t)),e[O]!=null&&(s[O]=__strictParseInt32(e[O])),s},vn=(e,t)=>{const s={};return e[C]!=null&&(s[C]=re(e[C],t)),s},Pn=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},_n=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},xn=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},Dn=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},kn=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},Mn=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},$n=(e,t)=>{const s={};return e[E]!=null&&(s[E]=(0,d.lK)(e[E])),s},b=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),Mo=(e,t)=>collectBody(e,t).then(s=>t.utf8Encoder(s)),Nn=(0,d.jr)(H),K=async(e,t,s,n,r)=>{const{hostname:o,protocol:i="https",port:a,path:c}=await e.endpoint(),y={protocol:i,hostname:o,port:a,method:"POST",path:c.endsWith("/")?c.slice(0,-1)+s:c+s,headers:t};return n!==void 0&&(y.hostname=n),r!==void 0&&(y.body=r),new se(y)},z={"content-type":"application/x-www-form-urlencoded"},G="2011-06-15",j="Action",oe="AccessKeyId",On="AssumeRole",Fe="AssumedRoleId",V="AssumedRoleUser",Ln="AssumeRoleWithSAML",Hn="AssumeRoleWithWebIdentity",Fn="AssumeRoot",ie="Account",q="Arn",ae="Audience",C="Credentials",We="ContextAssertion",Wn="DecodeAuthorizationMessage",Be="DecodedMessage",w="DurationSeconds",Ue="Expiration",Ke="ExternalId",ze="EncodedMessage",Ge="FederatedUser",je="FederatedUserId",Bn="GetAccessKeyInfo",Un="GetCallerIdentity",Kn="GetFederationToken",zn="GetSessionToken",Ve="Issuer",qe="Key",Ye="Name",Qe="NameQualifier",$="Policy",N="PolicyArns",Xe="PrincipalArn",Ze="ProviderArn",Je="ProvidedContexts",et="ProviderId",O="PackedPolicySize",tt="Provider",Y="RoleArn",ce="RoleSessionName",st="Subject",nt="SecretAccessKey",rt="SAMLAssertion",ot="SubjectFromWebIdentityToken",x="SourceIdentity",de="SerialNumber",it="SubjectType",at="SessionToken",le="Tags",ue="TokenCode",ct="TargetPrincipal",Dt="TaskPolicyArn",dt="TransitiveTagKeys",lt="UserId",Q="Version",ut="Value",ht="WebIdentityToken",mt="arn",E="message",X=e=>Object.entries(e).map(([t,s])=>(0,d.$6)(t)+"="+(0,d.$6)(s)).join("&"),Gn=(e,t)=>{if(t.Error?.Code!==void 0)return t.Error.Code;if(e.statusCode==404)return"NotFound"};class jn extends d.uB.classBuilder().ep(Pt).m(function(t,s,n,r){return[(0,vt.TM)(n,this.serialize,this.deserialize),(0,ve.rD)(n,t.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRole",{}).n("STSClient","AssumeRoleCommand").f(void 0,Os).ser(Gs).de(Vs).build(){}class Vn extends d.uB.classBuilder().ep(Pt).m(function(t,s,n,r){return[(0,vt.TM)(n,this.serialize,this.deserialize),(0,ve.rD)(n,t.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithWebIdentity",{}).n("STSClient","AssumeRoleWithWebIdentityCommand").f(Ls,Hs).ser(js).de(qs).build(){}const kt="us-east-1",Mt=e=>{if(typeof e?.Arn=="string"){const t=e.Arn.split(":");if(t.length>4&&t[4]!=="")return t[4]}},$t=async(e,t,s)=>{const n=typeof e=="function"?await e():e,r=typeof t=="function"?await t():t;return s?.debug?.("@aws-sdk/client-sts::resolveRegion","accepting first of:",`${n} (provider)`,`${r} (parent client)`,`${kt} (STS default)`),n??r??kt},Nt=(e,t)=>{let s,n;return async(r,o)=>{if(n=r,!s){const{logger:h=e?.parentClientConfig?.logger,region:R,requestHandler:S=e?.parentClientConfig?.requestHandler,credentialProviderLogger:A}=e,k=await $t(R,e?.parentClientConfig?.region,A),Z=!Lt(S);s=new t({credentialDefaultProvider:()=>async()=>n,region:k,requestHandler:Z?S:void 0,logger:h})}const{Credentials:i,AssumedRoleUser:a}=await s.send(new jn(o));if(!i||!i.AccessKeyId||!i.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRole call with role ${o.RoleArn}`);const c=Mt(a),y={accessKeyId:i.AccessKeyId,secretAccessKey:i.SecretAccessKey,sessionToken:i.SessionToken,expiration:i.Expiration,...i.CredentialScope&&{credentialScope:i.CredentialScope},...c&&{accountId:c}};return(0,Ie.g)(y,"CREDENTIALS_STS_ASSUME_ROLE","i"),y}},Ot=(e,t)=>{let s;return async n=>{if(!s){const{logger:c=e?.parentClientConfig?.logger,region:y,requestHandler:h=e?.parentClientConfig?.requestHandler,credentialProviderLogger:R}=e,S=await $t(y,e?.parentClientConfig?.region,R),A=!Lt(h);s=new t({region:S,requestHandler:A?h:void 0,logger:c})}const{Credentials:r,AssumedRoleUser:o}=await s.send(new Vn(n));if(!r||!r.AccessKeyId||!r.SecretAccessKey)throw new Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${n.RoleArn}`);const i=Mt(o),a={accessKeyId:r.AccessKeyId,secretAccessKey:r.SecretAccessKey,sessionToken:r.SessionToken,expiration:r.Expiration,...r.CredentialScope&&{credentialScope:r.CredentialScope},...i&&{accountId:i}};return i&&(0,Ie.g)(a,"RESOLVED_ACCOUNT_ID","T"),(0,Ie.g)(a,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),a}},$o=e=>t=>e({roleAssumer:Nt(t,t.stsClientCtor),roleAssumerWithWebIdentity:Ot(t,t.stsClientCtor),...t}),Lt=e=>e?.metadata?.handlerProtocol==="h2";var Ht=u(67317),qn=u(9383),Yn=u(92567),Ft=u(56264),ye=u(20512),ge=u(25158),Qn=u(51320),J;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(J||(J={}));const Re=3,Wt=J.STANDARD,Xn=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch"],Zn=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],Jn=["TimeoutError","RequestTimeout","RequestTimeoutException"],er=[500,502,503,504],tr=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],sr=e=>e.$retryable!==void 0,nr=e=>Xn.includes(e.name),rr=e=>e.$metadata?.clockSkewCorrected,Se=e=>e.$metadata?.httpStatusCode===429||Zn.includes(e.name)||e.$retryable?.throttling==!0,Ae=(e,t=0)=>rr(e)||Jn.includes(e.name)||tr.includes(e?.code||"")||er.includes(e.$metadata?.httpStatusCode||0)||e.cause!==void 0&&t<=10&&Ae(e.cause,t+1),or=e=>{if(e.$metadata?.httpStatusCode!==void 0){const t=e.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Ae(e)}return!1};class Ee{constructor(t){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=t?.beta??.7,this.minCapacity=t?.minCapacity??1,this.minFillRate=t?.minFillRate??.5,this.scaleConstant=t?.scaleConstant??.4,this.smooth=t?.smooth??.8;const s=this.getCurrentTimeInSeconds();this.lastThrottleTime=s,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(t){if(!!this.enabled){if(this.refillTokenBucket(),t>this.currentCapacity){const s=(t-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>Ee.setTimeoutFn(n,s))}this.currentCapacity=this.currentCapacity-t}}refillTokenBucket(){const t=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=t;return}const s=(t-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+s),this.lastTimestamp=t}updateClientSendingRate(t){let s;if(this.updateMeasuredRate(),Se(t)){const r=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=r,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),s=this.cubicThrottle(r),this.enableTokenBucket()}else this.calculateTimeWindow(),s=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(s,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(t){return this.getPrecise(t*this.beta)}cubicSuccess(t){return this.getPrecise(this.scaleConstant*Math.pow(t-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(t){this.refillTokenBucket(),this.fillRate=Math.max(t,this.minFillRate),this.maxCapacity=Math.max(t,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const t=this.getCurrentTimeInSeconds(),s=Math.floor(t*2)/2;if(this.requestCount++,s>this.lastTxRateBucket){const n=this.requestCount/(s-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=s}}getPrecise(t){return parseFloat(t.toFixed(8))}}Ee.setTimeoutFn=setTimeout;const Te=100,ft=20*1e3,Bt=500,yt=500,Ut=5,Kt=10,zt=1,Gt="amz-sdk-invocation-id",jt="amz-sdk-request",ir=()=>{let e=Te;return{computeNextBackoffDelay:n=>Math.floor(Math.min(ft,Math.random()*2**n*e)),setDelayBase:n=>{e=n}}},Vt=({retryDelay:e,retryCount:t,retryCost:s})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(ft,e),getRetryCost:()=>s});class gt{constructor(t){this.maxAttempts=t,this.mode=J.STANDARD,this.capacity=yt,this.retryBackoffStrategy=ir(),this.maxAttemptsProvider=typeof t=="function"?t:async()=>t}async acquireInitialRetryToken(t){return Vt({retryDelay:Te,retryCount:0})}async refreshRetryTokenForRetry(t,s){const n=await this.getMaxAttempts();if(this.shouldRetry(t,s,n)){const r=s.errorType;this.retryBackoffStrategy.setDelayBase(r==="THROTTLING"?Bt:Te);const o=this.retryBackoffStrategy.computeNextBackoffDelay(t.getRetryCount()),i=s.retryAfterHint?Math.max(s.retryAfterHint.getTime()-Date.now()||0,o):o,a=this.getCapacityCost(r);return this.capacity-=a,Vt({retryDelay:i,retryCount:t.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(t){this.capacity=Math.max(yt,this.capacity+(t.getRetryCost()??zt))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Re}`),Re}}shouldRetry(t,s,n){return t.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(s.errorType)&&this.isRetryableError(s.errorType)}getCapacityCost(t){return t==="TRANSIENT"?Kt:Ut}isRetryableError(t){return t==="THROTTLING"||t==="TRANSIENT"}}class ar{constructor(t,s){this.maxAttemptsProvider=t,this.mode=J.ADAPTIVE;const{rateLimiter:n}=s??{};this.rateLimiter=n??new Ee,this.standardRetryStrategy=new gt(t)}async acquireInitialRetryToken(t){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(t)}async refreshRetryTokenForRetry(t,s){return this.rateLimiter.updateClientSendingRate(s),this.standardRetryStrategy.refreshRetryTokenForRetry(t,s)}recordSuccess(t){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(t)}}class No extends gt{constructor(t,s=Te){super(typeof t=="function"?t:async()=>t),typeof s=="number"?this.computeNextBackoffDelay=()=>s:this.computeNextBackoffDelay=s}async refreshRetryTokenForRetry(t,s){const n=await super.refreshRetryTokenForRetry(t,s);return n.getRetryDelay=()=>this.computeNextBackoffDelay(n.getRetryCount()),n}}var qt=u(3682);const cr=(e,t)=>{const s=e,n=t?.noRetryIncrement??zt,r=t?.retryCost??Ut,o=t?.timeoutRetryCost??Kt;let i=e;const a=R=>R.name==="TimeoutError"?o:r,c=R=>a(R)<=i;return Object.freeze({hasRetryTokens:c,retrieveRetryTokens:R=>{if(!c(R))throw new Error("No retry token available");const S=a(R);return i-=S,S},releaseRetryTokens:R=>{i+=R??n,i=Math.min(i,s)}})},dr=(e,t)=>Math.floor(Math.min(ft,Math.random()*2**t*e)),lr=e=>e?sr(e)||nr(e)||Se(e)||Ae(e):!1,Yt=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):typeof e=="string"?new Error(e):new Error(`AWS SDK error wrapper for ${e}`);class ur{constructor(t,s){this.maxAttemptsProvider=t,this.mode=J.STANDARD,this.retryDecider=s?.retryDecider??lr,this.delayDecider=s?.delayDecider??dr,this.retryQuota=s?.retryQuota??cr(yt)}shouldRetry(t,s,n){return s<n&&this.retryDecider(t)&&this.retryQuota.hasRetryTokens(t)}async getMaxAttempts(){let t;try{t=await this.maxAttemptsProvider()}catch{t=Re}return t}async retry(t,s,n){let r,o=0,i=0;const a=await this.getMaxAttempts(),{request:c}=s;for(se.isInstance(c)&&(c.headers[Gt]=(0,qt.A)());;)try{se.isInstance(c)&&(c.headers[jt]=`attempt=${o+1}; max=${a}`),n?.beforeRequest&&await n.beforeRequest();const{response:y,output:h}=await t(s);return n?.afterRequest&&n.afterRequest(y),this.retryQuota.releaseRetryTokens(r),h.$metadata.attempts=o+1,h.$metadata.totalRetryDelay=i,{response:y,output:h}}catch(y){const h=Yt(y);if(o++,this.shouldRetry(h,o,a)){r=this.retryQuota.retrieveRetryTokens(h);const R=this.delayDecider(Se(h)?Bt:Te,o),S=hr(h.$response),A=Math.max(S||0,R);i+=A,await new Promise(k=>setTimeout(k,A));continue}throw h.$metadata||(h.$metadata={}),h.$metadata.attempts=o,h.$metadata.totalRetryDelay=i,h}}}const hr=e=>{if(!Le.isInstance(e))return;const t=Object.keys(e.headers).find(o=>o.toLowerCase()==="retry-after");if(!t)return;const s=e.headers[t],n=Number(s);return Number.isNaN(n)?new Date(s).getTime()-Date.now():n*1e3};class Oo extends ur{constructor(t,s){const{rateLimiter:n,...r}=s??{};super(t,r),this.rateLimiter=n??new Ee,this.mode=J.ADAPTIVE}async retry(t,s){return super.retry(t,s,{beforeRequest:async()=>this.rateLimiter.getSendToken(),afterRequest:n=>{this.rateLimiter.updateClientSendingRate(n)}})}}var Ce=u(42952);const Qt="AWS_MAX_ATTEMPTS",Xt="max_attempts",mr={environmentVariableSelector:e=>{const t=e[Qt];if(!t)return;const s=parseInt(t);if(Number.isNaN(s))throw new Error(`Environment variable ${Qt} mast be a number, got "${t}"`);return s},configFileSelector:e=>{const t=e[Xt];if(!t)return;const s=parseInt(t);if(Number.isNaN(s))throw new Error(`Shared config file entry ${Xt} mast be a number, got "${t}"`);return s},default:Re},fr=e=>{const{retryStrategy:t}=e,s=(0,Ce.t)(e.maxAttempts??Re);return{...e,maxAttempts:s,retryStrategy:async()=>t||(await(0,Ce.t)(e.retryMode)()===J.ADAPTIVE?new ar(s):new gt(s))}},yr="AWS_RETRY_MODE",gr="retry_mode",Rr={environmentVariableSelector:e=>e[yr],configFileSelector:e=>e[gr],default:Wt},Er=()=>e=>async t=>{const{request:s}=t;return HttpRequest.isInstance(s)&&(delete s.headers[INVOCATION_ID_HEADER],delete s.headers[REQUEST_HEADER]),e(t)},Tr={name:"omitRetryHeadersMiddleware",tags:["RETRY","HEADERS","OMIT_RETRY_HEADERS"],relation:"before",toMiddleware:"awsAuthMiddleware",override:!0},Lo=e=>({applyToStack:t=>{t.addRelativeTo(Er(),Tr)}});var Rt=u(2203);const pr=e=>e?.body instanceof Rt.Readable||typeof ReadableStream<"u"&&e?.body instanceof ReadableStream,Sr=e=>(t,s)=>async n=>{let r=await e.retryStrategy();const o=await e.maxAttempts();if(Ar(r)){r=r;let i=await r.acquireInitialRetryToken(s.partition_id),a=new Error,c=0,y=0;const{request:h}=n,R=se.isInstance(h);for(R&&(h.headers[Gt]=(0,qt.A)());;)try{R&&(h.headers[jt]=`attempt=${c+1}; max=${o}`);const{response:S,output:A}=await t(n);return r.recordSuccess(i),A.$metadata.attempts=c+1,A.$metadata.totalRetryDelay=y,{response:S,output:A}}catch(S){const A=Cr(S);if(a=Yt(S),R&&pr(h))throw(s.logger instanceof d.N4?console:s.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{i=await r.refreshRetryTokenForRetry(i,A)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=c+1,a.$metadata.totalRetryDelay=y,a}c=i.getRetryCount();const k=i.getRetryDelay();y+=k,await new Promise(Z=>setTimeout(Z,k))}}else return r=r,r?.mode&&(s.userAgent=[...s.userAgent||[],["cfg/retry-mode",r.mode]]),r.retry(t,n)},Ar=e=>typeof e.acquireInitialRetryToken<"u"&&typeof e.refreshRetryTokenForRetry<"u"&&typeof e.recordSuccess<"u",Cr=e=>{const t={error:e,errorType:wr(e)},s=vr(e.$response);return s&&(t.retryAfterHint=s),t},wr=e=>Se(e)?"THROTTLING":Ae(e)?"TRANSIENT":or(e)?"SERVER_ERROR":"CLIENT_ERROR",br={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},Ir=e=>({applyToStack:t=>{t.add(Sr(e),br)}}),vr=e=>{if(!Le.isInstance(e))return;const t=Object.keys(e.headers).find(o=>o.toLowerCase()==="retry-after");if(!t)return;const s=e.headers[t],n=Number(s);return Number.isNaN(n)?new Date(s):new Date(n*1e3)};var Pr=u(9252);const _r=async(e,t,s)=>({operation:(0,Ce.u)(t).operation,region:await(0,Ce.t)(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function xr(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"sts",region:e.region},propertiesExtractor:(t,s)=>({signingProperties:{config:t,context:s}})}}function Zt(e){return{schemeId:"smithy.api#noAuth"}}const Dr=e=>{const t=[];switch(e.operation){case"AssumeRoleWithSAML":{t.push(Zt(e));break}case"AssumeRoleWithWebIdentity":{t.push(Zt(e));break}default:t.push(xr(e))}return t},kr=e=>({...e,stsClientCtor:wt}),Mr=e=>{const t=kr(e);return{...(0,Pr.h)(t)}},$r={rE:"3.693.0"};var Nr=u(96554),Jt=u(33723),es=u(16757),ts=u(60847),Or=u(51461),he=u(75854),Lr=u(26656),Et=u(58611),Tt=u(65692);const Hr=["ECONNRESET","EPIPE","ETIMEDOUT"],Fr=e=>{const t={};for(const s of Object.keys(e)){const n=e[s];t[s]=Array.isArray(n)?n.join(","):n}return t},D={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e)},ss=1e3,Wr=(e,t,s=0)=>{if(!s)return-1;const n=r=>{const o=D.setTimeout(()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${s} ms`),{name:"TimeoutError"}))},s-r),i=a=>{a?.connecting?a.on("connect",()=>{D.clearTimeout(o)}):D.clearTimeout(o)};e.socket?i(e.socket):e.on("socket",i)};return s<2e3?(n(0),0):D.setTimeout(n.bind(null,ss),ss)},Br=3e3,Ur=(e,{keepAlive:t,keepAliveMsecs:s},n=Br)=>{if(t!==!0)return-1;const r=()=>{e.socket?e.socket.setKeepAlive(t,s||0):e.on("socket",o=>{o.setKeepAlive(t,s||0)})};return n===0?(r(),0):D.setTimeout(r,n)},ns=3e3,Kr=(e,t,s=0)=>{const n=r=>{const o=s-r,i=()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${s} ms`),{name:"TimeoutError"}))};e.socket?e.socket.setTimeout(o,i):e.setTimeout(o,i)};return 0<s&&s<6e3?(n(0),0):D.setTimeout(n.bind(null,s===0?0:ns),ns)},rs=1e3;async function zr(e,t,s=rs){const n=t.headers??{},r=n.Expect||n.expect;let o=-1,i=!0;r==="100-continue"&&(i=await Promise.race([new Promise(a=>{o=Number(D.setTimeout(a,Math.max(rs,s)))}),new Promise(a=>{e.on("continue",()=>{D.clearTimeout(o),a(!0)}),e.on("response",()=>{D.clearTimeout(o),a(!1)}),e.on("error",()=>{D.clearTimeout(o),a(!1)})})])),i&&Gr(e,t.body)}function Gr(e,t){if(t instanceof Rt.Readable){t.pipe(e);return}if(t){if(Buffer.isBuffer(t)||typeof t=="string"){e.end(t);return}const s=t;if(typeof s=="object"&&s.buffer&&typeof s.byteOffset=="number"&&typeof s.byteLength=="number"){e.end(Buffer.from(s.buffer,s.byteOffset,s.byteLength));return}e.end(Buffer.from(t));return}e.end()}const Ho=0;class we{static create(t){return typeof t?.handle=="function"?t:new we(t)}static checkSocketUsage(t,s,n=console){const{sockets:r,requests:o,maxSockets:i}=t;if(typeof i!="number"||i===1/0)return s;const a=15e3;if(Date.now()-a<s)return s;if(r&&o)for(const c in r){const y=r[c]?.length??0,h=o[c]?.length??0;if(y>=i&&h>=2*i)return n?.warn?.(`@smithy/node-http-handler:WARN - socket usage at capacity=${y} and ${h} additional requests are enqueued.
See https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/node-configuring-maxsockets.html
or increase socketAcquisitionWarningTimeout=(millis) in the NodeHttpHandler config.`),Date.now()}return s}constructor(t){this.socketWarningTimestamp=0,this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise((s,n)=>{typeof t=="function"?t().then(r=>{s(this.resolveDefaultConfig(r))}).catch(n):s(this.resolveDefaultConfig(t))})}resolveDefaultConfig(t){const{requestTimeout:s,connectionTimeout:n,socketTimeout:r,httpAgent:o,httpsAgent:i}=t||{},a=!0,c=50;return{connectionTimeout:n,requestTimeout:s??r,httpAgent:(()=>o instanceof Et.Agent||typeof o?.destroy=="function"?o:new Et.Agent({keepAlive:a,maxSockets:c,...o}))(),httpsAgent:(()=>i instanceof Tt.Agent||typeof i?.destroy=="function"?i:new Tt.Agent({keepAlive:a,maxSockets:c,...i}))(),logger:console}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(t,{abortSignal:s}={}){return this.config||(this.config=await this.configProvider),new Promise((n,r)=>{let o;const i=[],a=async g=>{await o,i.forEach(D.clearTimeout),n(g)},c=async g=>{await o,i.forEach(D.clearTimeout),r(g)};if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(s?.aborted){const g=new Error("Request aborted");g.name="AbortError",c(g);return}const y=t.protocol==="https:",h=y?this.config.httpsAgent:this.config.httpAgent;i.push(D.setTimeout(()=>{this.socketWarningTimestamp=we.checkSocketUsage(h,this.socketWarningTimestamp,this.config.logger)},this.config.socketAcquisitionWarningTimeout??(this.config.requestTimeout??2e3)+(this.config.connectionTimeout??1e3)));const R=(0,Lr.G)(t.query||{});let S;if(t.username!=null||t.password!=null){const g=t.username??"",_=t.password??"";S=`${g}:${_}`}let A=t.path;R&&(A+=`?${R}`),t.fragment&&(A+=`#${t.fragment}`);let k=t.hostname??"";k[0]==="["&&k.endsWith("]")?k=t.hostname.slice(1,-1):k=t.hostname;const Z={headers:t.headers,host:k,method:t.method,path:A,port:t.port,agent:h,auth:S},B=(y?Tt.request:Et.request)(Z,g=>{const _=new Le({statusCode:g.statusCode||-1,reason:g.statusMessage,headers:Fr(g.headers),body:g});a({response:_})});if(B.on("error",g=>{Hr.includes(g.code)?c(Object.assign(g,{name:"TimeoutError"})):c(g)}),s){const g=()=>{B.destroy();const _=new Error("Request aborted");_.name="AbortError",c(_)};if(typeof s.addEventListener=="function"){const _=s;_.addEventListener("abort",g,{once:!0}),B.once("close",()=>_.removeEventListener("abort",g))}else s.onabort=g}i.push(Wr(B,c,this.config.connectionTimeout)),i.push(Kr(B,c,this.config.requestTimeout));const fe=Z.agent;typeof fe=="object"&&"keepAlive"in fe&&i.push(Ur(B,{keepAlive:fe.keepAlive,keepAliveMsecs:fe.keepAliveMsecs})),o=zr(B,t,this.config.requestTimeout).catch(g=>(i.forEach(D.clearTimeout),r(g)))})}updateHttpClientConfig(t,s){this.config=void 0,this.configProvider=this.configProvider.then(n=>({...n,[t]:s}))}httpHandlerConfigs(){return this.config??{}}}var Fo=u(85675);class Wo{constructor(t){this.sessions=[],this.sessions=t??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(t){this.sessions.push(t)}contains(t){return this.sessions.includes(t)}remove(t){this.sessions=this.sessions.filter(s=>s!==t)}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(t){for(const s of this.sessions)s===t&&(s.destroyed||s.destroy())}}class Bo{constructor(t){if(this.sessionCache=new Map,this.config=t,this.config.maxConcurrency&&this.config.maxConcurrency<=0)throw new RangeError("maxConcurrency must be greater than zero.")}lease(t,s){const n=this.getUrlString(t),r=this.sessionCache.get(n);if(r){const c=r.poll();if(c&&!this.config.disableConcurrency)return c}const o=http2.connect(n);this.config.maxConcurrency&&o.settings({maxConcurrentStreams:this.config.maxConcurrency},c=>{if(c)throw new Error("Fail to set maxConcurrentStreams to "+this.config.maxConcurrency+"when creating new session for "+t.destination.toString())}),o.unref();const i=()=>{o.destroy(),this.deleteSession(n,o)};o.on("goaway",i),o.on("error",i),o.on("frameError",i),o.on("close",()=>this.deleteSession(n,o)),s.requestTimeout&&o.setTimeout(s.requestTimeout,i);const a=this.sessionCache.get(n)||new NodeHttp2ConnectionPool;return a.offerLast(o),this.sessionCache.set(n,a),o}deleteSession(t,s){const n=this.sessionCache.get(t);!n||!n.contains(s)||(n.remove(s),this.sessionCache.set(t,n))}release(t,s){const n=this.getUrlString(t);this.sessionCache.get(n)?.offerLast(s)}destroy(){for(const[t,s]of this.sessionCache){for(const n of s)n.destroyed||n.destroy(),s.remove(n);this.sessionCache.delete(t)}}setMaxConcurrentStreams(t){if(t&&t<=0)throw new RangeError("maxConcurrentStreams must be greater than zero.");this.config.maxConcurrency=t}setDisableConcurrentStreams(t){this.config.disableConcurrency=t}getUrlString(t){return t.destination.toString()}}class os{static create(t){return typeof t?.handle=="function"?t:new os(t)}constructor(t){this.metadata={handlerProtocol:"h2"},this.connectionManager=new NodeHttp2ConnectionManager({}),this.configProvider=new Promise((s,n)=>{typeof t=="function"?t().then(r=>{s(r||{})}).catch(n):s(t||{})})}destroy(){this.connectionManager.destroy()}async handle(t,{abortSignal:s}={}){this.config||(this.config=await this.configProvider,this.connectionManager.setDisableConcurrentStreams(this.config.disableConcurrentStreams||!1),this.config.maxConcurrentStreams&&this.connectionManager.setMaxConcurrentStreams(this.config.maxConcurrentStreams));const{requestTimeout:n,disableConcurrentStreams:r}=this.config;return new Promise((o,i)=>{let a=!1,c;const y=async p=>{await c,o(p)},h=async p=>{await c,i(p)};if(s?.aborted){a=!0;const p=new Error("Request aborted");p.name="AbortError",h(p);return}const{hostname:R,method:S,port:A,protocol:k,query:Z}=t;let bt="";if(t.username!=null||t.password!=null){const p=t.username??"",F=t.password??"";bt=`${p}:${F}@`}const B=`${k}//${bt}${R}${A?`:${A}`:""}`,fe={destination:new URL(B)},g=this.connectionManager.lease(fe,{requestTimeout:this.config?.sessionTimeout,disableConcurrentStreams:r||!1}),_=p=>{r&&this.destroySession(g),a=!0,h(p)},Ms=buildQueryString(Z||{});let It=t.path;Ms&&(It+=`?${Ms}`),t.fragment&&(It+=`#${t.fragment}`);const L=g.request({...t.headers,[constants.HTTP2_HEADER_PATH]:It,[constants.HTTP2_HEADER_METHOD]:S});if(g.ref(),L.on("response",p=>{const F=new HttpResponse({statusCode:p[":status"]||-1,headers:getTransformedHeaders(p),body:L});a=!0,y({response:F}),r&&(g.close(),this.connectionManager.deleteSession(B,g))}),n&&L.setTimeout(n,()=>{L.close();const p=new Error(`Stream timed out because of no activity for ${n} ms`);p.name="TimeoutError",_(p)}),s){const p=()=>{L.close();const F=new Error("Request aborted");F.name="AbortError",_(F)};if(typeof s.addEventListener=="function"){const F=s;F.addEventListener("abort",p,{once:!0}),L.once("close",()=>F.removeEventListener("abort",p))}else s.onabort=p}L.on("frameError",(p,F,co)=>{_(new Error(`Frame type id ${p} in stream id ${co} has failed with code ${F}.`))}),L.on("error",_),L.on("aborted",()=>{_(new Error(`HTTP/2 stream is abnormally aborted in mid-communication with result code ${L.rstCode}.`))}),L.on("close",()=>{g.unref(),r&&g.destroy(),a||_(new Error("Unexpected error: http2 request did not get a response"))}),c=writeRequestBody(L,t,n)})}updateHttpClientConfig(t,s){this.config=void 0,this.configProvider=this.configProvider.then(n=>({...n,[t]:s}))}httpHandlerConfigs(){return this.config??{}}destroySession(t){t.destroyed||t.destroy()}}class jr extends Rt.Writable{constructor(){super(...arguments),this.bufferedBytes=[]}_write(t,s,n){this.bufferedBytes.push(t),n()}}const Vr=e=>qr(e)?Yr(e):new Promise((t,s)=>{const n=new jr;e.pipe(n),e.on("error",r=>{n.end(),s(r)}),n.on("error",s),n.on("finish",function(){const r=new Uint8Array(Buffer.concat(this.bufferedBytes));t(r)})}),qr=e=>typeof ReadableStream=="function"&&e instanceof ReadableStream;async function Yr(e){const t=[],s=e.getReader();let n=!1,r=0;for(;!n;){const{done:a,value:c}=await s.read();c&&(t.push(c),r+=c.length),n=a}const o=new Uint8Array(r);let i=0;for(const a of t)o.set(a,i),i+=a.length;return o}var Qr=u(88226),Xr=u(42640),is=u(61821),as=u(17053),Zr=u(43988),pt=u(5332);const cs="required",l="type",m="fn",f="argv",ee="ref",ds=!1,St=!0,te="booleanEquals",I="stringEquals",ls="sigv4",us="sts",hs="us-east-1",T="endpoint",ms="https://sts.{Region}.{PartitionResult#dnsSuffix}",W="tree",me="error",At="getAttr",fs={[cs]:!1,[l]:"String"},Ct={[cs]:!0,default:!1,[l]:"Boolean"},ys={[ee]:"Endpoint"},gs={[m]:"isSet",[f]:[{[ee]:"Region"}]},v={[ee]:"Region"},Rs={[m]:"aws.partition",[f]:[v],assign:"PartitionResult"},Es={[ee]:"UseFIPS"},Ts={[ee]:"UseDualStack"},P={url:"https://sts.amazonaws.com",properties:{authSchemes:[{name:ls,signingName:us,signingRegion:hs}]},headers:{}},M={},ps={conditions:[{[m]:I,[f]:[v,"aws-global"]}],[T]:P,[l]:T},Ss={[m]:te,[f]:[Es,!0]},As={[m]:te,[f]:[Ts,!0]},Cs={[m]:At,[f]:[{[ee]:"PartitionResult"},"supportsFIPS"]},ws={[ee]:"PartitionResult"},bs={[m]:te,[f]:[!0,{[m]:At,[f]:[ws,"supportsDualStack"]}]},Is=[{[m]:"isSet",[f]:[ys]}],vs=[Ss],Ps=[As],Jr={version:"1.0",parameters:{Region:fs,UseDualStack:Ct,UseFIPS:Ct,Endpoint:fs,UseGlobalEndpoint:Ct},rules:[{conditions:[{[m]:te,[f]:[{[ee]:"UseGlobalEndpoint"},St]},{[m]:"not",[f]:Is},gs,Rs,{[m]:te,[f]:[Es,ds]},{[m]:te,[f]:[Ts,ds]}],rules:[{conditions:[{[m]:I,[f]:[v,"ap-northeast-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"ap-south-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"ap-southeast-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"ap-southeast-2"]}],endpoint:P,[l]:T},ps,{conditions:[{[m]:I,[f]:[v,"ca-central-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"eu-central-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"eu-north-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"eu-west-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"eu-west-2"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"eu-west-3"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"sa-east-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,hs]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"us-east-2"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"us-west-1"]}],endpoint:P,[l]:T},{conditions:[{[m]:I,[f]:[v,"us-west-2"]}],endpoint:P,[l]:T},{endpoint:{url:ms,properties:{authSchemes:[{name:ls,signingName:us,signingRegion:"{Region}"}]},headers:M},[l]:T}],[l]:W},{conditions:Is,rules:[{conditions:vs,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[l]:me},{conditions:Ps,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[l]:me},{endpoint:{url:ys,properties:M,headers:M},[l]:T}],[l]:W},{conditions:[gs],rules:[{conditions:[Rs],rules:[{conditions:[Ss,As],rules:[{conditions:[{[m]:te,[f]:[St,Cs]},bs],rules:[{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:M,headers:M},[l]:T}],[l]:W},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[l]:me}],[l]:W},{conditions:vs,rules:[{conditions:[{[m]:te,[f]:[Cs,St]}],rules:[{conditions:[{[m]:I,[f]:[{[m]:At,[f]:[ws,"name"]},"aws-us-gov"]}],endpoint:{url:"https://sts.{Region}.amazonaws.com",properties:M,headers:M},[l]:T},{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dnsSuffix}",properties:M,headers:M},[l]:T}],[l]:W},{error:"FIPS is enabled but this partition does not support FIPS",[l]:me}],[l]:W},{conditions:Ps,rules:[{conditions:[bs],rules:[{endpoint:{url:"https://sts.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:M,headers:M},[l]:T}],[l]:W},{error:"DualStack is enabled but this partition does not support DualStack",[l]:me}],[l]:W},ps,{endpoint:{url:ms,properties:M,headers:M},[l]:T}],[l]:W}],[l]:W},{error:"Invalid Configuration: Missing Region",[l]:me}]},eo=new pt.kS({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS","UseGlobalEndpoint"]}),to=(e,t={})=>eo.get(e,()=>(0,pt.sO)(Jr,{endpointParams:e,logger:t.logger}));pt.mw.aws=Zr.UF;const so=e=>({apiVersion:"2011-06-15",base64Decoder:e?.base64Decoder??is.E,base64Encoder:e?.base64Encoder??is.n,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??to,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??Dr,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:t=>t.getIdentityProvider("aws.auth#sigv4"),signer:new Jt.f2},{schemeId:"smithy.api#noAuth",identityProvider:t=>t.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new ge.mR}],logger:e?.logger??new d.N4,serviceId:e?.serviceId??"STS",urlParser:e?.urlParser??Xr.D,utf8Decoder:e?.utf8Decoder??as.ar,utf8Encoder:e?.utf8Encoder??as.Pq});var no=u(12165);const ro=e=>{(0,d.I9)(process.version);const t=(0,no.I)(e),s=()=>t().then(d.lT),n=so(e);return(0,Nr.I)(process.version),{...n,...e,runtime:"node",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??Qr.n,credentialDefaultProvider:e?.credentialDefaultProvider??es.v6,defaultUserAgentProvider:e?.defaultUserAgentProvider??(0,ts.pf)({serviceId:n.serviceId,clientVersion:$r.rE}),httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:r=>r.getIdentityProvider("aws.auth#sigv4")||(async o=>await(0,es.v6)(o?.__config||{})()),signer:new Jt.f2},{schemeId:"smithy.api#noAuth",identityProvider:r=>r.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new ge.mR}],maxAttempts:e?.maxAttempts??(0,he.Z)(mr),region:e?.region??(0,he.Z)(ye.GG,ye.zH),requestHandler:we.create(e?.requestHandler??s),retryMode:e?.retryMode??(0,he.Z)({...Rr,default:async()=>(await s()).retryMode||Wt}),sha256:e?.sha256??Or.V.bind(null,"sha256"),streamCollector:e?.streamCollector??Vr,useDualstackEndpoint:e?.useDualstackEndpoint??(0,he.Z)(ye.e$),useFipsEndpoint:e?.useFipsEndpoint??(0,he.Z)(ye.Ko),userAgentAppId:e?.userAgentAppId??(0,he.Z)(ts.hV)}};var _s=u(13848);const oo=e=>{const t=e.httpAuthSchemes;let s=e.httpAuthSchemeProvider,n=e.credentials;return{setHttpAuthScheme(r){const o=t.findIndex(i=>i.schemeId===r.schemeId);o===-1?t.push(r):t.splice(o,1,r)},httpAuthSchemes(){return t},setHttpAuthSchemeProvider(r){s=r},httpAuthSchemeProvider(){return s},setCredentials(r){n=r},credentials(){return n}}},io=e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials()}),be=e=>e,ao=(e,t)=>{const s={...be((0,_s.Rq)(e)),...be((0,d.xA)(e)),...be(Us(e)),...be(oo(e))};return t.forEach(n=>n.configure(s)),{...e,...(0,_s.$3)(s),...(0,d.uv)(s),...Ks(s),...io(s)}};class wt extends d.Kj{constructor(...[t]){const s=ro(t||{}),n=Ns(s),r=(0,Ft.Dc)(n),o=fr(r),i=(0,ye.TD)(o),a=(0,Ht.OV)(i),c=(0,ve.Co)(a),y=Mr(c),h=ao(y,t?.extensions||[]);super(h),this.config=h,this.middlewareStack.use((0,Ft.sM)(this.config)),this.middlewareStack.use(Ir(this.config)),this.middlewareStack.use((0,Qn.vK)(this.config)),this.middlewareStack.use((0,Ht.TC)(this.config)),this.middlewareStack.use((0,qn.Y7)(this.config)),this.middlewareStack.use((0,Yn.n4)(this.config)),this.middlewareStack.use((0,ge.wB)(this.config,{httpAuthSchemeParametersProvider:_r,identityProviderConfigProvider:async R=>new ge.h$({"aws.auth#sigv4":R.credentials})})),this.middlewareStack.use((0,ge.lW)(this.config))}destroy(){super.destroy()}}const xs=(e,t)=>t?class extends e{constructor(n){super(n);for(const r of t)this.middlewareStack.use(r)}}:e,Ds=(e={},t)=>Nt(e,xs(wt,t)),ks=(e={},t)=>Ot(e,xs(wt,t)),Ko=e=>t=>e({roleAssumer:Ds(t),roleAssumerWithWebIdentity:ks(t),...t})}};
